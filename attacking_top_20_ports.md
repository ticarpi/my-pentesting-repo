# Attacking the Top 20 TCP Ports

This is a breakdown of some useful attack vectors that will get you started on 95% of targets in a pentest.


## Nmap Top 20 TCP ports
* 21/tcp == ftp
* 22/tcp == ssh*
* 23/tcp == telnet
* 25/tcp == smtp
* 53/tcp == dns
* 80/tcp == http
* 110/tcp == pop3
* 111/tcp == rpcbind (?)     
* 135/tcp == msrpc (?)   
* 139/tcp == netbios-ssn
* 143/tcp == imap
* 443/tcp == https*
* 445/tcp == microsoft-ds
* 993/tcp == imaps* 
* 995/tcp == pop3s*    
* 1723/tcp == pptp*  
* 3306/tcp == mysql
* 3389/tcp == ms-wbt-server (?)           
* 5900/tcp == vnc*   
* 8080/tcp == http-proxy
     
**Encrypted ports*  

---

## Attack Methodology

### Preamble:
* First up ***identify your ports***.  
> Make sure you check all ports on TCP and UDP.  
* Your friend here is `unicornscan` - this is also leveraged by onetwopunch.sh, which can be downloaded from [https://github.com/superkojiman/onetwopunch](https://github.com/superkojiman/onetwopunch).

* Use version detection in `nmap` (*-sV*) to grab banners and detect more enumeration data - which can lead to identifying weaknesses and exploits.


### 21 - FTP - *File Transfer Protocol*

#### What?
Transfer of files using a remote, browsable directory.

#### Usage
1. `$ ftp <ip_addr>`  
1. enter username  
1. enter password  
1. [command] - use `help` for a list  

#### Common Weaknesses
* Anonymous FTP - allows upload of malicious files
* Anonymous FTP - allows download of sensitive files
  * ssh keys
* Lack of bruteforce prevention
* Often unpatched against exploits

#### Attack Strategy
* Check for anonymous login
  * anonymous:email_addr OR anonymous:<blank>
* Check for banner and match exploits
* MitM and capture plaintext creds

---

### 22 - SSH - *Secure Shell*

#### What?
Remote shell access via encrypted connection

#### Usage
* `$ ssh <user>:<ip_addr>`  
  * enter password (unless using id_rsa.pub in *~/.ssh* dir)  
* `$ ssh <user>:<ip_addr> [command]`  

#### Common Weaknesses
* Lack of bruteforce protection
* Common passwords

#### Attack Strategy
* Check for banner
* Enumerate user accounts
* Bruteforce user accounts (with `hydra`)

---


### 23 - Telnet

#### What?
Remote shell access via unencrypted connection.  
Also used for serving a commandline application to remote users.

#### Usage

#### Common Weaknesses
* Lack of bruteforce protection
* Application exit-able - allowing local shell access or access to management application

#### Attack Strategy
* Check banner for clues to OS/usernames
* Enumerate user accounts
* Bruteforce user accounts
* Check for weaknesses by exiting currently running application

---


25
53
80
110
111
135
139
143
443
445
993
995
1723
3306
3389
5900
8080

---

### 

#### What?

#### Usage

#### Common Weaknesses

#### Attack Strategy
